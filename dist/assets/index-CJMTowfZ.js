import{K as w,r as g,P as R,Q as L,j as t,o as C,h as M,M as b,I as B,T as S,c as O,m as $,L as j,n as m,G as Y}from"./index-D_FUGIIp.js";import{D as T}from"./DetailSide-DLLnR6tg.js";import{a as k,I as q}from"./index-BUeTSdxD.js";import{A as E}from"./index-vgXJCGMk.js";import{R as F,C as P}from"./CommentList-7nqey51D.js";import"./MyPaginate-Bjy7FdvU.js";const A="_wrapper_64oca_1",G="_right_64oca_6",z="_title_64oca_9",Q="_mv_64oca_20",D="_singer_64oca_26",H="_info_64oca_35",K="_value_64oca_42",V="_btns_64oca_47",W="_paginate_64oca_52",c={wrapper:A,right:G,title:z,mv:Q,singer:D,info:H,value:K,btns:V,paginate:W},J="_title_wqnru_1",U="_lyric_wqnru_13",X="_scroll_wqnru_18",Z="_line_wqnru_24",I="_active_wqnru_36",ee="_empty_wqnru_61",p={title:J,lyric:U,scroll:X,line:Z,active:I,empty:ee};function te(){const o=w(),e=g.useRef(null),l=g.useRef(null),u=g.useRef(null),h=R(s=>s.player.currentTime),a=R(s=>s.player.currentMusic),{data:n,isFetching:v}=L({id:o.id||""}),_=g.useMemo(()=>a.rid&&a.rid.toString()===o.id&&(n==null?void 0:n.data.lrclist)&&(n==null?void 0:n.data.lrclist.find((s,r)=>{var i;return h>=+s.time&&h<+(((i=n.data.lrclist[r+1])==null?void 0:i.time)||999999)})),[n,h,a.rid,o.id]),[N,y]=g.useState(-50);g.useEffect(()=>{if(a.rid&&a.rid.toString()===o.id&&l.current&&u.current){const s=e.current.getBoundingClientRect(),r=l.current.getBoundingClientRect(),i=u.current.getBoundingClientRect();y(i.top-r.top-s.height/2+i.height/2)}else y(-50)},[_,a.rid,o.id]);const f=s=>{if(!l.current||!e.current)return;s.preventDefault();const r=l.current.getBoundingClientRect().top-e.current.getBoundingClientRect().top;console.log(r);const i=-(l.current.getBoundingClientRect().height-e.current.getBoundingClientRect().height/2);console.log("bottom",i);const x=-(-e.current.getBoundingClientRect().height/2);console.log("top",x);let d=r;(s.deltaY>0&&r>i||s.deltaY<0&&r<x)&&(d-=s.deltaY*2.3),d<i?d=i:d>x&&(d=x),l.current.style.transform=`translateY(${d}px)`};return g.useEffect(()=>{const s=e.current;return s&&s.addEventListener("wheel",r=>{f(r)},{passive:!1}),()=>{s&&s.removeEventListener("wheel",r=>{f(r)})}},[v]),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:p.title,children:t.jsx("h2",{children:"歌词"})}),v?t.jsx(C,{style:{marginTop:"100px"}}):n!=null&&n.data.lrclist?t.jsx("div",{ref:e,className:p.lyric,children:t.jsx("div",{ref:l,style:{transform:`translateY(${-N}px)`},className:p.scroll,children:n.data.lrclist.map(s=>s.lineLyric.trim()!==""?t.jsx("p",{ref:_===s?u:null,className:M(p.line,{[p.active]:_===s}),children:s.lineLyric},`${s.time}-${s.lineLyric}`):null)})}):t.jsxs("div",{className:p.empty,children:[t.jsx(b,{src:B}),t.jsx("p",{children:"暂无歌词"})]})]})}function ce(){const o=w(),{data:e,isFetching:l}=S({id:o.id||""}),{addOneToList:u,playOne:h}=O(),{openModalWithDefaultText:a}=$();return t.jsx(t.Fragment,{children:t.jsx("div",{className:"container",children:t.jsxs("div",{className:c.wrapper,children:[t.jsx(T,{type:"song",img:(e==null?void 0:e.data.pic)||"",info:(e==null?void 0:e.data.albuminfo)||"暂无简介"}),t.jsxs("div",{className:c.right,children:[l?t.jsx(C,{style:{marginTop:"80px"}}):t.jsxs(t.Fragment,{children:[t.jsxs("h3",{className:c.title,children:[e==null?void 0:e.data.name,(e==null?void 0:e.data.hasmv)===1&&t.jsx(j,{to:`/mvplay/${e.data.rid}`,className:c.mv,children:t.jsx("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"10551",width:"1em",height:"1em",children:t.jsx("path",{d:"M588.245333 414.464a27.050667 27.050667 0 0 0-15.616-25.386667 31.445333 31.445333 0 0 0-40.661333 13.098667l-53.76 95.701333-53.76-95.744a31.445333 31.445333 0 0 0-34.688-15.189333 29.141333 29.141333 0 0 0-22.912 28.501333v184.533334a29.141333 29.141333 0 0 0 58.282667 0v-77.866667l24.661333 43.904a31.445333 31.445333 0 0 0 28.16 16.042667 31.445333 31.445333 0 0 0 28.586667-16.042667l23.424-41.6v75.562667a29.141333 29.141333 0 0 0 58.282666 0V415.488v-0.981333z m181.376 108.16L713.813333 402.986667a29.013333 29.013333 0 0 0-38.656-13.952 29.013333 29.013333 0 0 0-14.165333 38.613333l81.578667 174.933333a29.141333 29.141333 0 0 0 24.064 18.005334 28.928 28.928 0 0 0 29.952-17.834667l81.621333-175.104a29.013333 29.013333 0 0 0-14.165333-38.570667 29.013333 29.013333 0 0 0-38.656 13.952l-55.765334 119.594667zM315.477333 228.266667a1113.002667 1113.002667 0 0 1 284.501334-36.224c97.621333 0 192.170667 12.032 283.776 36.053333a154.538667 154.538667 0 0 1 112.938666 126.634667 979.413333 979.413333 0 0 1 0 296.32 154.538667 154.538667 0 0 1-112.938666 126.634666 1113.173333 1113.173333 0 0 1-283.733334 36.053334c-97.877333 0-192.725333-12.074667-284.586666-36.266667a154.581333 154.581333 0 0 1-112.853334-127.189333 999.936 999.936 0 0 1-10.581333-147.370667c0-50.986667 3.541333-100.096 10.581333-147.370667A154.581333 154.581333 0 0 1 315.477333 228.266667z",fill:"#666","p-id":"10552"})})})]}),t.jsx(j,{className:c.singer,to:`/singer/${e==null?void 0:e.data.artistid}`,children:e==null?void 0:e.data.artist}),t.jsxs("p",{className:c.info,children:["专辑：",t.jsx(j,{to:`/album/${e==null?void 0:e.data.albumid}`,className:c.value,children:e==null?void 0:e.data.album}),"发行时间：",t.jsx("span",{className:c.value,children:e==null?void 0:e.data.releaseDate})]}),t.jsxs("div",{className:c.btns,children:[t.jsx(m,{onClick:()=>h(e==null?void 0:e.data),style:{marginRight:"10px"},icon:t.jsx(k,{}),type:"yellow",children:"立即播放"}),t.jsx(m,{onClick:()=>u(e==null?void 0:e.data),style:{marginRight:"10px"},icon:t.jsx(q,{}),children:"添加"}),t.jsx(m,{onClick:a,style:{marginRight:"10px"},icon:t.jsx(E,{}),children:"收藏"}),t.jsx(m,{onClick:a,style:{marginRight:"10px"},icon:t.jsx(F,{}),children:"分享"}),t.jsx(m,{onClick:a,icon:t.jsx(Y,{}),children:"评论"})]})]}),t.jsx(te,{}),t.jsx(P,{type:"music",id:o.id||""})]})]})})})}export{ce as default};
